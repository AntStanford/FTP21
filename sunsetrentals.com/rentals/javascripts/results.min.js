var bookingFolder="/rentals";function submitForm(){$("#refineForm, #sortForm").find("[name=page]").val(0),$.ajax({type:"POST",url:bookingFolder+"/ajax/results.cfm",data:$("#refineForm, #sortForm").serialize(),beforeSend:function(){$(".results-loader-overlay").fadeIn(200)},success:function(e){var t=function(e){for(var t=e+"=",a=document.cookie.split(";"),s=0;s<a.length;s++){for(var r=a[s];" "==r.charAt(0);)r=r.substring(1);if(-1!=r.indexOf(t))return r.substring(t.length,r.length)}return""}("NUMRESULTS");$("#bottom-result").attr("data-count",t),$(".props-return").text(t),$("#list-all-results").html(e),$(".results-loader-overlay").fadeOut(200),$(".owl-carousel.results-featured-carousel").length&&$(".owl-carousel.results-featured-carousel").owlCarousel({lazyLoad:!0,loop:!1,center:!1,nav:!0,navText:["<i class='fa fa-chevron-left'></i>","<i class='fa fa-chevron-right'></i>"],dots:!0,margin:15,responsive:{0:{items:1},737:{items:2},2000:{items:3}}});var a=$("#refineForm input[name=strCheckin]").val(),s=$("#refineForm input[name=strCheckout]").val();Math.floor(100*Math.random()+1);""!=a&&""!=s?($(".hidden-sort").show(),$.ajax({type:"POST",url:bookingFolder+"/ajax/get-percentage-booked.cfm",data:$("#refineForm, #sortForm").serialize(),success:function(e){$(".percent-booked-ajax");if(e>0&&t>0){$("#results-list-alert-popular-post").remove();var a=Math.ceil(e);$("#results-list-alert-popular-ajax span.percent-booked-ajax").html(a),$("#results-list-alert-popular-ajax").show()}else $("#results-list-alert-popular-post").remove(),$("#results-list-alert-popular-ajax").hide()}})):$("#results-list-alert-popular-ajax").hide(),$.ajax({type:"POST",url:bookingFolder+"/ajax/map-all-results.cfm",data:$("#refineForm, #sortForm").serialize(),dataType:"json",success:function(e){var t=serializeCFJSON(e);drawMapAllResults(map,markers,t)},error:function(e,t,a){}})}})}$(document).ready(function(){function e(){$(".refine-filter-box").hasClass("hidden")||($(".refine-filter-box").addClass("hidden"),$(".refine-filters").find(".fa-chevron-up").addClass("fa-chevron-down").removeClass("fa-chevron-up"))}$(".refine-text").on("click",function(){$(this).next().hasClass("hidden")?(e(),$(".refine-dropdown").addClass("hidden"),$(this).addClass("active"),$(".refine-text").find(".fa-chevron-up").addClass("fa-chevron-down").removeClass("fa-chevron-up"),$(this).find(".fa-chevron-down").removeClass("fa-chevron-down").addClass("fa-chevron-up"),$(this).next().removeClass("hidden")):($(this).removeClass("active"),$(this).find(".fa-chevron-up").addClass("fa-chevron-down").removeClass("fa-chevron-up"),$(this).next().addClass("hidden"))}),$(document).on("click",function(e){$(e.target).is(".refine-text, .refine-text *, .refine-dropdown, .refine-dropdown *, .refine-filter-box, .refine-filter-box *, .ui-datepicker-next, .ui-datepicker-next *, .ui-datepicker-prev, .ui-datepicker-prev *, .amen-arrow")?e.stopPropagation():($(".refine-dropdown, .refine-filter-box").addClass("hidden"),$(".refine-text").removeClass("active"),$(".refine-text").find(".fa-chevron-up").addClass("fa-chevron-down").removeClass("fa-chevron-up"))}),$(".refine-apply, .refine-close").on("click",function(){$(this).parent().hasClass("refine-dropdown")&&$(this).parent().addClass("hidden"),$(this).parent().hasClass("refine-filter-action")&&$(this).parent().parent().addClass("hidden"),$(this).parent().parent().hasClass("refine-filter-box")?$(this).parent().parent().prev().find(".fa-chevron-up").addClass("fa-chevron-down").removeClass("fa-chevron-up"):$(this).parent().prev().find(".fa-chevron-up").addClass("fa-chevron-down").removeClass("fa-chevron-up")}),$(window).width()<1024&&$(".refine-apply").on("click",function(){$("#viewFiltersMobile").html('<i class="fa fa-toggle-off site-color-1" aria-hidden="true"></i> <span class="site-color-1">Refine</span>'),$(".refine-text").hasClass("active")&&($(".refine-dropdown").addClass("hidden"),$(".refine-text").removeClass("active")),$(".refine-form").addClass("mobile-hidden");var e=$(".booking-header-wrap").outerHeight()+$(".refine-mobile-controls").outerHeight()+15;$("html, body").animate({scrollTop:$("#scrollReturn").position().top-e},800)});var t=1;if($(window).width()>768)t=[1,2];else t=1;var a=new Date,s=$("#startDateRefine").val();function r(e,t,a,s){var r=new google.maps.InfoWindow({size:new google.maps.Size(150,50)}),i=new OverlappingMarkerSpiderfier(e,{markersWontMove:!0,markersWontHide:!0,basicFormatEvents:!0,keepSpiderfied:!0,circleSpiralSwitchover:"Infinity"});if(t.length)for(var o=t.length-1;o>=0;o--)t[o].setMap(null),t[o]=null,t.splice(o,1);var n=new google.maps.LatLngBounds;if(a.length)for(o=0;o<a.length;o++){var l=a[o];if(null!=l.latitude){f=new google.maps.LatLng(l.latitude,l.longitude);function d(e){google.maps.event.addListener(e,"mouseover",function(){var t={url:bookingFolder+"/images/marker-hover.png",scaledSize:new google.maps.Size(28,39)};e.setIcon(t)}),google.maps.event.addListener(e,"mouseout",function(){var t={url:bookingFolder+"/images/marker.png",scaledSize:new google.maps.Size(28,39)};e.setIcon(t)}),$(".results-list-property").mouseover(function(){var e=$(this).attr("data-mapMarkerID"),a={url:bookingFolder+"/images/marker-hover.png",scaledSize:new google.maps.Size(28,39)};t[e].setIcon(a),t[e].setZIndex(100)}),$(".results-list-property").mouseout(function(){var e=$(this).attr("data-mapMarkerID"),a={url:bookingFolder+"/images/marker.png",scaledSize:new google.maps.Size(28,39)};t[e].setIcon(a),t[e].setZIndex(1)})}!function(t,a){var s='<a href="'+bookingFolder+"/"+t.seopropertyname+'" target="_blank"><img src="'+t.mapphoto+'" width="180" height="100" /></a><h4><a href="'+bookingFolder+"/"+t.seopropertyname+'" target="_blank">'+t.unitshortname+"</a></h4><strong>"+t.bedrooms+" BR | Sleeps "+t.maxoccupancy+" | "+t.bathrooms+' Baths</strong><br><a class="btn btn-mini site-color-1-bg site-color-1-lighten-bg-hover text-white" href="'+bookingFolder+"/"+t.seopropertyname+'" target="_blank">Learn More</a>';google.maps.event.addListener(a,"spider_click",function(){r.setContent(s),r.open(e,a)}),google.maps.event.addListener(e,"spider_click",function(){r.close()}),i.addMarker(a)}(l,c=new google.maps.Marker({map:e,position:new google.maps.LatLng(l.latitude,l.longitude),icon:bookingFolder+"/images/marker.png",zIndex:1})),n.extend(f),d(c),t.push(c)}}else{var c,f=new google.maps.LatLng(29.699594,-85.376316);function d(e){google.maps.event.addListener(e,"mouseover",function(){var t={url:bookingFolder+"/images/marker-hover.png",scaledSize:new google.maps.Size(28,39)};e.setIcon(t)}),google.maps.event.addListener(e,"mouseout",function(){var t={url:bookingFolder+"/images/marker.png",scaledSize:new google.maps.Size(28,39)};e.setIcon(t)})}!function(t,a){google.maps.event.addListener(a,"spider_click",function(){r.setContent('<a href="/about-us/contact-us/" target="_blank"><h4>Our Office</h4></a>23110 US Hwy 6, Unit 6<br>Keystone, Colorado 80435'),r.open(e,a)}),google.maps.event.addListener(e,"spider_click",function(){r.close()}),i.addMarker(a)}(0,c=new google.maps.Marker({map:e,position:new google.maps.LatLng(29.699594,-85.376316),icon:bookingFolder+"/images/marker.png",zIndex:1})),n.extend(f),d(c),n.extend(f)}e.fitBounds(n)}$.datepicker.setDefaults({dateFormat:"mm/dd/yy",minDate:a}),$("#refineDatepicker").datepicker({defaultDate:s,numberOfMonths:t,beforeShowDay:function(e){var t=$.datepicker.parseDate($.datepicker._defaults.dateFormat,$("#startDateRefine").val()),a=$.datepicker.parseDate($.datepicker._defaults.dateFormat,$("#endDateRefine").val());return[!0,t&&(e.getTime()==t.getTime()||a&&e>=t&&e<=a)?"dp-highlight":""]},onSelect:function(e,t){var a=$.datepicker.parseDate($.datepicker._defaults.dateFormat,$("#startDateRefine").val()),s=$.datepicker.parseDate($.datepicker._defaults.dateFormat,$("#endDateRefine").val()),r=$.datepicker.parseDate($.datepicker._defaults.dateFormat,e);!a||s?($("#startDateRefine").val(e).addClass("date-entered"),$("#endDateRefine").val("").addClass("date-entered"),console.log("Start Date Entered")):r<a?($("#endDateRefine").val($("startDateRefine").val()),$("#startDateRefine").val(e),console.log("You are going Backwards!")):($("#endDateRefine").val(e),console.log("End Date Entered"))}}),$(document).on("click",".refine-clear",function(){$("#refineDatepicker").datepicker("refresh"),$("#refineDatepicker").datepicker("setDate",new Date),$("#startDateRefine").val("").removeClass("date-entered").datepicker("refresh"),$("#endDateRefine").val("").removeClass("date-entered").datepicker("refresh"),$(".ui-datepicker-calendar td").removeClass("dp-highlight"),$(this).parent().siblings().find(".fa-chevron-up").removeClass("fa-chevron-up").addClass("fa-chevron-down"),$("#flexDates").prop("checked",!1),$("#flexed").val(""),$(".results-tab-bar").addClass("hidden"),submitForm()}),$(document).on("click","#refineDatesApply",function(){submitForm()}),$(".refine-counter").each(function(){var e=$(this).parent().find(".refine-count"),t=$(this).parent().find(".refine-drop-count"),a=e.text(),s=$(this).find(".refine-drop-count").data("min"),r=$(this).find(".refine-drop-count").data("max"),i=a;a>s&&$(this).find(".fa-minus").removeClass("disabled"),$(this).find(".fa-plus").on("click",function(){i>=s&&i<r&&(i++,e.text(i),t.text(i),$(this).prev().prev().removeClass("disabled")),i===r&&$(this).addClass("disabled")}),$(this).find(".fa-minus").on("click",function(){i<=r&&i>s&&(--i,e.text(i),t.text(i),$(this).next().next().removeClass("disabled")),i===s&&$(this).addClass("disabled")})}),$(".refine-guests-counter-wrap").length&&$("#refineGuestsCountApply").on("click",function(){var e=$(".refine-guests .refine-count").text();$(".refine-guests input[name=sleeps]").val(e),console.log("guestCount: "+e),submitForm()}),$(".refine-bedrooms-counter-wrap").length&&$("#refineBedsCountApply").on("click",function(){var e=$(".refine-beds").text();$("input[name=bedrooms]").val(e),console.log("bedCount: "+e),submitForm()}),$(".refine-bathrooms-counter-wrap").length&&$("#refineBathsCountApply").on("click",function(){var e=$(".refine-baths").text();$("input[name=bathrooms]").val(e),console.log("bathCount: "+e),submitForm()}),$("#refineMoreFiltersApply").on("click",function(){var e=$(".refine-filter-checkbox[type=checkbox]:checked").length;$("#filtersCount").text("("+e+")")}),$(".refine-filter-checkbox").on("click",function(){$(".refine-filter-checkbox[type=checkbox]:checked").length,$(this).prop("checked")}),$(".refine-filter-see-all").on("click",function(){$(this).prev().toggleClass("hidden"),$(this).find(".fa").toggleClass("fa-chevron-down").toggleClass("fa-chevron-up")}),$(document).on("click","#refineMoreFiltersApply",function(){submitForm()}),window.map=new google.maps.Map(document.getElementById("map"),{zoom:14,maxZoom:18,mapTypeId:google.maps.MapTypeId.street,styles:[{featureType:"poi.business",stylers:[{visibility:"off"}]}]}),window.markers=[],$.ajax({type:"POST",url:bookingFolder+"/ajax/map-all-results.cfm",data:$("#refineForm, #sortForm").serialize(),dataType:"json",success:function(e){var t=o(e);r(map,markers,t)},error:function(e,t,a){}}),window.drawMapAllResults=r,window.serializeCFJSON=o;var i=!1;function o(e){for(var t=[],a=0;a<e.DATA.length;a++){for(var s={},r=e.DATA[a],i=0;i<e.COLUMNS.length;i++)s[e.COLUMNS[i].toLowerCase()]=r[i];t.push(s)}return t}$(window).on("scroll",function(e){var t=$("#bottom-result"),a=$("#refineForm, #sortForm"),s=t.offset().top;if($(window).scrollTop()+$(window).height()>s){var r=parseInt(t.attr("data-count")),o=parseInt(a.find("[name=page]").val());o+1<Math.ceil(r/12)&&!i&&(t.addClass("loading"),i=!0,a.find("[name=page]").val(o+1),$.ajax({type:"POST",url:bookingFolder+"/ajax/results.cfm?scroll",data:a.serialize(),success:function(e){setTimeout(function(){$("#list-all-results").append(e),t.removeClass("loading"),i=!1,console.log("This is from the inifinite scroll ajax"),$(".owl-carousel.result-property-carousel").length&&loadResultsOwl()},500)}}))}}),$(".refine-filter-select-all").on("click",function(){var e=$(this).closest(".refine-filter-section").find(".refine-filter-checkbox"),t=$(this).prop("checked");e.prop("checked",t),$(this).next().text("Deselect All"==$(this).next().text()?"Select All":"Deselect All")}),$(".refine-filter-checkbox").on("click",function(){var e=$(this).closest(".refine-filter-section").find(".refine-filter-checkbox"),t=$(this).closest(".refine-filter-section").find(".refine-filter-select-all"),a=$(this).closest(".refine-filter-section").find(".select-all");!$(e).filter(":checked").length>0&&($(t).prop("checked",!1),$(a).text("Select All")),$(e).filter(":checked").length==$(e).length?($(t).prop("checked",!0),$(a).text("Deselect All")):($(t).prop("checked",!1),$(a).text("Select All"))}),$(".refine-filter-specific-property-select").change(function(){var e=$(this).val();window.open(e,"_blank").location}),$("#sortForm").on("click",function(e){e.stopPropagation(),$(this).find("ul").toggleClass("hidden")}),$("#sortForm ul li").on("click",function(){var e=$(this).find("span").text();$("#resultsListSortTitle i").text(e);var t=$(this).attr("data-resultsList");$("#refineForm").find("input[name=strSortBy]").val(t),submitForm()}),$("#viewListAndMap").on("click",function(){e(),$(".results-list-wrap").hasClass("results-list-full-width")?$(this).html('<i class="fa fa-th-large site-color-1" aria-hidden="true"></i><span class="site-color-1">Grid View</span>'==$(this).html()?'<i class="fa fa-columns site-color-1" aria-hidden="true"></i><span class="site-color-1">Split View</span>':'<i class="fa fa-th-large site-color-1" aria-hidden="true"></i><span class="site-color-1">Grid View</span>'):$(this).html('<i class="fa fa-columns site-color-1" aria-hidden="true"></i><span class="site-color-1">Split View</span>'==$(this).html()?'<i class="fa fa-th-large site-color-1" aria-hidden="true"></i><span class="site-color-1">Grid View</span>':'<i class="fa fa-columns site-color-1" aria-hidden="true"></i><span class="site-color-1">Split View</span>'),$(".results-list-wrap").toggleClass("results-list-full-width").removeClass("hidden"),$(".map-wrap").toggleClass("hidden").removeClass("map-wrap-full"),setTimeout(function(){var e=map.getCenter();google.maps.event.trigger(map,"resize"),map.setCenter(e),$(".results-featured-carousel").trigger("refresh.owl.carousel"),$(".result-property-carousel").trigger("refresh.owl.carousel")},500)}),$("#viewMapOnly").on("click",function(){var t;(e(),$(".results-list-wrap").toggleClass("hidden").removeClass("results-list-full-width"),$(".map-wrap").toggleClass("map-wrap-full").removeClass("hidden"),$("#viewListAndMap").toggleClass("inactive"),!$(".results-list-wrap").hasClass("results-list-full-width")||$(".map-wrap").hasClass("map-wrap-full")?$("#viewListAndMap").children("i").addClass("fa-th-large").removeClass("fa-columns"):$(".results-list-wrap").hasClass("results-list-full-width")?$("#viewListAndMap").children("i").addClass("fa-columns").removeClass("fa-th-large"):$("#viewListAndMap").children("i").addClass("fa-th-large").removeClass("fa-columns"),$(window).width()<1200&&('<a href="javascript:;" id="viewFiltersMobile" rel="tooltip" data-placement="bottom" title="" data-original-title="Refine"><i class="fa site-color-1 fa-toggle-on" aria-hidden="true"></i> <span class="site-color-1">Close Refine</span></a>'===$("#viewFiltersMobile").html()?$("#viewFiltersMobile").html('<i class="fa site-color-1 fa-toggle-on" aria-hidden="true"></i> <span class="site-color-1">Close Refine</span>'):$("#viewFiltersMobile").html('<i class="fa fa-toggle-off site-color-1" aria-hidden="true"></i> <span class="site-color-1">Refine</span>'),$(".refine-form").addClass("mobile-hidden")),$(window).width()>1025&&$(window).width()<1200)&&("Map View"===(t=$(this).find("span")).text()?(t.text("Grid View"),$(this).children("i").addClass("fa-th-large").removeClass("fa-map-marker")):(t.text("Map View"),$(this).children("i").addClass("fa-map-marker").removeClass("fa-columns")));$(window).width()<1024&&("Map View"===(t=$(this).find("span")).text()?(t.text("Grid View"),$(this).children("i").addClass("fa-th-large").removeClass("fa-map-marker")):(t.text("Map View"),$(this).children("i").addClass("fa-map-marker").removeClass("fa-th-large")));$(window).width()<736&&$(".booking-footer-wrap").toggleClass("hidden"),setTimeout(function(){$.ajax({type:"POST",url:bookingFolder+"/ajax/map-all-results.cfm",data:$("#refineForm, #sortForm").serialize(),dataType:"json",success:function(e){var t=o(e);r(map,markers,t)},error:function(e,t,a){}});var e=map.getCenter();google.maps.event.trigger(map,"resize"),map.setCenter(e)},500),console.log("map btn has been clicked")}),$("#viewFiltersMobile").on("click",function(){var e=$(this).find("span");"Refine"===e.text()?(e.text("Close Refine"),$(this).children("i").addClass("fa-toggle-on").removeClass("fa-toggle-off")):(e.text("Refine"),$(this).children("i").addClass("fa-toggle-off").removeClass("fa-toggle-on")),$(".refine-form").toggleClass("mobile-hidden")}),$(".results-list-property-img-wrap").on("click",".results-list-property-special",function(){var e=$(this).parent().find(".special-modal-content").html();$("#specialModalContent").html(e)}),$("form#noResultsContactForm").validate({submitHandler:function(e){return $.ajax({type:"POST",url:"_submit.cfm",data:$("form#noResultsContactForm").serialize(),dataType:"text",success:function(e){e=$.trim(e),console.log(e),"success"===e&&($(".caption").hide(),$("form#noResultsContactForm").hide(),$("div#noResultsContactFormMSG").html("<font color='green'>Thanks! Your email has been sent!</font>"))}}),!1}})});